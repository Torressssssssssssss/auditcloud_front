<div class="empresas-page">
  <div class="page-header">
    <h2>Empresas Auditoras</h2>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label>Filtrar por país/estado:</label>
      <input type="text" placeholder="Buscar..." [value]="filtroPais()" (input)="filtroPais.set($any($event.target).value)" />
    </div>
    <div class="filter-group">
      <label>Módulos:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" [checked]="modulosSeleccionados().includes(1)" (change)="toggleModulo(1)" /> Agua</label>
        <label><input type="checkbox" [checked]="modulosSeleccionados().includes(2)" (change)="toggleModulo(2)" /> Residuos</label>
        <label><input type="checkbox" [checked]="modulosSeleccionados().includes(3)" (change)="toggleModulo(3)" /> Energía</label>
      </div>
    </div>
  </div>

  @if (loading()) {
    <app-loading-spinner />
  } @else if (empresasFiltradas.length === 0) {
    <app-empty-state mensaje="No hay empresas auditoras disponibles" />
  } @else {
    <div class="empresas-grid">
      @for (empresa of empresasFiltradas; track empresa.id_empresa) {
        <div class="empresa-card">
          <h3>{{ empresa.nombre }}</h3>
          <div class="empresa-info">
            <p><strong>Ubicación:</strong> {{ empresa.pais || 'N/A' }}{{ empresa.estado ? ', ' + empresa.estado : '' }}</p>
            <p><strong>Módulos:</strong> {{ getModulosTexto(empresa.modulos) }}</p>
          </div>
          <div class="empresa-actions">
            <a [routerLink]="['/cliente/empresas', empresa.id_empresa]" class="btn btn-secondary">
              Ver perfil
            </a>
            <button class="btn btn-primary" (click)="contactar(empresa.id_empresa)">
              Contactar
            </button>
          </div>
        </div>
      }
    </div>
  }
</div>






